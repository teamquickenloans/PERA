 <!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
  	<title>Parking Dashboard</title>
	<!-- <link rel="stylesheet" type="text/css" href="dashboard.css"> -->

	<!-- ====================== jQuery ============================== -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" type="text/javascript"></script>
	
	<!-- ====================== AngularJS ============================== -->
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.11/angular.min.js"></script>

  	<!-- ====================== Foundation ============================ -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.0/css/foundation.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.0/js/foundation.min.js"></script>

	
	<!-- ====================== Google Maps API ============================ -->
	<style type="text/css">
		html { height:100%; }
		body { height:100%; }
		body { background-color:#CCC; }
		#map-canvas { height:1000px; }
		#sideBar { height:1000px; overflow:auto;}
		#mainTabs, #sideTabs { height:50px; }
		.row { max-width: 100%; }
    </style>

    <script type="text/javascript" 
    	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBV-BwHOcVyVW0e8yJa1sAk5GBFtm5YeHM">
    </script>

    <script type="text/javascript">
		function initialize() {
	  
		var styleArray = [
			{
				featureType: "water",
				stylers: [
					{ color: '#666666' }
				]
			},{
				featureType: "all",
				stylers: [
					{ saturation: -100 }
				]
			},{
				featureType: "road",
				elementType: "geometry",
				stylers: [
					{ visibility: "simplified" }
				]
			},{
				featureType: "poi.business",
				elementType: "labels",
				stylers: [
					{ visibility: "off" }
				]
			}
		];

        var mapOptions = {
			center: {lat: 42.33242, lng: -83.04646},
			zoom: 16,
			styles: styleArray,
			panControl: false,
  			zoomControl: false,
		  	mapTypeControl: true,
		  	scaleControl: false,
		  	streetViewControl: false,
		  	overviewMapControl: false
        };
		
        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
			




        garageMarkers = [];
        garageNumber = 0;
        geocoder = new google.maps.Geocoder();
        function testClick(event) {
        	console.log('in here');
        }
        function AddGarage(name, address)
        {
        	//TODO: Geocoding should only be done once upon garage entry into the database, not on each page load!!!
        	//Convert Address to Latitude & Longitude and Create Marker/Marker Listener
		  	geocoder.geocode( { 'address': address }, function(results, status) 
		  	{
		    	if (status == google.maps.GeocoderStatus.OK) 
		    	{
		    		//Create Marker
		      		garageMarkers[garageNumber] = new google.maps.Marker({
		          		map: map,
		          		position: results[0].geometry.location,
		          		icon: 'parking-small.png'
		      		});

		      		//Create Marker Listener
		      		google.maps.event.addListener(garageMarkers[garageNumber], 'click', function() {
			    		//TODO: Change sideBar
			  		});
		    	} 
		    	else 
		    	{
		      		//alert('Geocode was not successful for the following reason: ' + status);
		    	};
		  	});


			//Create Dropdown Entry
			var newButton = $("<li id='garageButton" + garageNumber + "'></li>");
			var newAnchor = $("<a href='#'>" + name + "</a>")
			console.log("here");
			console.log(newAnchor)
			
			newButton.html(newAnchor);
			$('#dropdownTopBar').append(newButton);

			var c = $('#garageButton' + garageNumber).find('a');
			c.on('click', function(event) {
				event.preventDefault();
				console.log("CLICK");
			})

			//Make Dropdown Entry Do Something
			// $("#garageButton" + garageNumber).on('click', function() 
			// {
			// 	alert("here I am!"); //TODO
	  // 			//map.setZoom(16);
	  //   		//map.setCenter(garageMarkers[garageNumber].getPosition());
	  // 		});


			garageNumber++;
        };


       



        //Read Garages From JSON file
		$.getJSON('garages.json', function(data) 
		{    
		    for(var i=0; i<data.garage.length; i++)
		    {
		        var obj = data.garage[i];
		        AddGarage(obj.name, obj.address);
		    }
		});




		
		// //Create control panel (ie. site title and 2 buttons) which appears on the right-hand side.
		// var controlPanelDiv = document.createElement('div');
	

		// //Add the control panel and reset button (created previously) to the map.
		// map.controls[google.maps.ControlPosition.RIGHT_TOP].push(controlPanelDiv);

      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>

</head>

<body>

	<!-- ======================== Nav Bar ============================ -->
	<nav class="top-bar" data-topbar role="navigation">
	  <ul class="title-area">
	    <li class="name">
	      <h1><a href="#">Parking Dashboard</a></h1>
	    </li>
	     <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
	    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
	  </ul>

	  <section class="top-bar-section">
	    <!-- Right Nav Section -->
	    <ul class="right">
	      <li class="active"><a href="#">Overview</a></li>
	      <li class="has-dropdown">
	        <a href="#">Single Garage</a>
	        <ul id="dropdownTopBar" class="dropdown">
	          <!-- <li><a href="#">First link in dropdown</a></li>
	          <li class="active"><a href="#">Active link in dropdown</a></li> -->
	        </ul>
	      </li>
	    </ul>

	    <!-- Left Nav Section -->
	    <ul class="left">
	      <li class="active"><a href="#">Parking Allocation</a></li>
	      <li><a href="#">Expense Reconcilliation</a></li>
	    </ul>
	  </section>
	</nav>







	<!-- ======================== Parking Allocation Content ============================ -->
	<div class="row">

			<div id="map-canvas" class="columns small-10"></div>
			<div id="sideBar" class="columns small-2">
				<!-- TODO: add garage info -->
			</div>

	</div>

</body>

</html> 